Backport of:

From 22bc0820f62d5a8488e32699e927aa1d08a762db Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 9 Mar 2017 07:27:42 -0500
Subject: [PATCH] CVE-2017-9098: use of uninitialized memory in RLE decoder

Reset memory for RLE decoder (patch provided by scarybeasts)

bug: https://scarybeastsecurity.blogspot.com/2017/05/bleed-continues-18-byte-file-14k-bounty.html
bug-debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=862967
origin: https://github.com/ImageMagick/ImageMagick/commit/1c358ffe0049f768dd49a8a889c1cbf99ac9849b
---
 coders/rle.c | 1 +
 1 file changed, 1 insertion(+)

Index: imagemagick-6.7.7.10/coders/rle.c
===================================================================
--- imagemagick-6.7.7.10.orig/coders/rle.c	2017-05-26 09:07:27.365701395 -0400
+++ imagemagick-6.7.7.10/coders/rle.c	2017-05-26 09:11:43.548964420 -0400
@@ -349,6 +349,7 @@ static Image *ReadRLEImage(const ImageIn
       ThrowReaderException(ResourceLimitError,"MemoryAllocationFailed");
     pixel_info_length=image->columns*image->rows*
       MagickMax(number_planes_filled,4);
+    (void) ResetMagickMemory(rle_pixels,0,pixel_info_length);
     if ((flags & 0x01) && !(flags & 0x02))
       {
         ssize_t
